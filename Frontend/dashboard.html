<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dashboard - NetPing</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Custom styles -->
    <link href="css/styles.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />

    <!-- FontAwesome -->
    <script
      src="https://use.fontawesome.com/releases/v6.3.0/js/all.js"
      crossorigin="anonymous"
    ></script>

    <style>
      body {
        background-color: #f5f6fa;
      }

      .device-card {
        background: #fff;
        border-radius: 12px;
        padding: 16px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        height: 100%;
      }

      .sensor-item {
        display: flex;
        justify-content: space-between;
        padding: 4px 0;
      }

      .sensor-value {
        font-weight: 600;
      }
    </style>

    <!-- TOKEN CHECK -->
    <script>
      const token = localStorage.getItem("token");
      if (!token) {
        window.location.href = "/login.html";
      }
      const role = localStorage.getItem("role");
    </script>
  </head>

  <body class="sb-nav-fixed">
    <!-- TOP NAVBAR -->
    <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
      <a class="navbar-brand ps-3" href="dashboard.html">
        NetPing monitoring
      </a>

      <button class="btn btn-link btn-sm me-3" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </button>

      <div class="ms-auto me-3">
        <button class="btn btn-outline-light" onclick="logout()">
          ðŸšª Logout
        </button>
      </div>
    </nav>

    <!-- Door alert -->
    <div
      id="doorToast"
      class="position-fixed top-0 end-0 m-3 alert alert-danger d-none shadow"
      style="z-index: 9999; min-width: 320px"
    ></div>

    <!-- LAYOUT -->
    <div id="layoutSidenav">
      <!-- SIDEBAR -->
      <div id="layoutSidenav_nav">
        <nav class="sb-sidenav accordion sb-sidenav-dark">
          <div class="sb-sidenav-menu">
            <div class="nav">
              <div class="sb-sidenav-menu-heading">Core</div>

              <a class="nav-link active" href="dashboard.html">
                <i class="fas fa-tachometer-alt me-2"></i> Dashboard
              </a>

              <div class="sb-sidenav-menu-heading">Management</div>

              <a class="nav-link" id="devicesLink" href="devices.html">
                <i class="fas fa-network-wired me-2"></i> Devices
              </a>

              <a class="nav-link" id="usersLink" href="user.html">
                <i class="fas fa-users me-2"></i> Users
              </a>
            </div>
          </div>
        </nav>
      </div>

      <!-- CONTENT -->
      <div id="layoutSidenav_content">
        <main>
          <!-- HEADER -->
          <div class="container-fluid px-4 mt-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div>
                <h1 class="mb-0">Dashboard</h1>
                <small class="text-muted">Monitoring Overview</small>
              </div>

              <!-- REGION FILTER -->
              <div
                class="d-flex align-items-center gap-2"
                style="min-width: 220px"
              >
                <label class="fw-semibold mb-0">Region:</label>
                <select class="form-select" id="regionFilter">
                  <option value="">All</option>
                </select>
              </div>
            </div>
          </div>

          <hr class="mb-4" />

          <!-- DEVICES -->
          <div class="container-fluid px-4">
            <h4 class="mb-3">Devices</h4>

            <div class="row g-4" id="deviceCards">
              <!-- device cards JS orqali keladi -->
            </div>
          </div>
        </main>

        <!-- FOOTER -->
        <footer class="py-4 bg-light mt-auto">
          <div
            class="container-fluid px-4 d-flex justify-content-between small"
          >
            <div class="text-muted">Â© shuhratCoder</div>
          </div>
        </footer>
      </div>
    </div>

    <!-- SCRIPTS -->
    <script>
      if (role !== "admin") {
        document.getElementById("devicesLink").style.display = "none";
        document.getElementById("usersLink").style.display = "none";
      }

      function logout() {
        localStorage.removeItem("token");
        localStorage.removeItem("role");
        window.location.href = "/login.html";
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/scripts.js"></script>
    <script src="dashboard.js"></script>

    <audio
      id="doorAlertSound"
      src="./sounds/warning.mp3"
      preload="auto"
    ></audio>
  </body>
</html>
